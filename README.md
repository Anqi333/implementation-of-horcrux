Payment Channel Networks (PCNs) have been highlighted as viable solutions to address the scalability issue in current permissionless blockchains by facilitating off-chain transactions and reducing the load on the blockchain. However, the extensive reuse of multi-hop routes in the same direction poses a risk of channel depletion, ultimately resulting in channels becoming unidirectional or even closing, thereby compromising the sustainability and scalability of PCNs. Even more concerning, existing rebalancing protocol solutions heavily rely on trust assumptions and scripting languages, resulting in compromised universality and reliability.

In this paper, we introduce the concept of flow neutrality as the ultimate goal for rebalancing protocols, aiming to minimize the impact on channel balance allocations during multi-hop payments (MHPs). We present Horcrux, a universal and efficient multi-party virtual channel protocol, that fundamentally addresses the channel depletion problem, without relying on trust assumptions, scripting languages, or the perpetual online requirement.

Horcrux is implemented using generalized channels as the underlying payment channel protocol and is tested on the network simulated from a real Lightning Network (LN) snapshot. The running cost is demonstrated with implementations respectively based on ECDSA and Schnorr signatures in the 'basic_implementation' project. Further, we conduct comparative simulations of Horcrux, Shaduf, and Revive on this real LN testnet within the 'simulation_in_testnet' project. It is important to note that the provided implementation of Horcrux is conceptual and not yet industry-ready. Before real-world application, a more thorough coding and security analysis based on our protocol, is essential.